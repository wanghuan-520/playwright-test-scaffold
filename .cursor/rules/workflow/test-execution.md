---
alwaysApply: true
---

# ğŸš€ è‡ªåŠ¨æµ‹è¯•æ‰§è¡Œæµç¨‹

**æµ‹è¯•ä»£ç ç”Ÿæˆå®Œæˆåï¼Œè‡ªåŠ¨æ‰§è¡Œä»¥ä¸‹æµç¨‹ï¼š**

## æ‰§è¡Œæµç¨‹

```
0. æ¸…ç†æ—§çš„æµ‹è¯•æ•°æ®ï¼ˆå¿…é¡»ï¼‰â­
   â”œâ”€ åˆ é™¤ allure-results/ï¼ˆæ—§çš„æµ‹è¯•ç»“æœæ•°æ®ï¼‰
   â”œâ”€ åˆ é™¤ allure-report/ï¼ˆæ—§çš„ HTML æŠ¥å‘Šï¼‰
   â”œâ”€ åˆ é™¤ screenshots/ï¼ˆæ—§çš„æµ‹è¯•æˆªå›¾ï¼‰
   â””â”€ ç¡®ä¿æ¯æ¬¡æµ‹è¯•éƒ½æ˜¯å¹²å‡€çš„å¼€å§‹

1. æ£€æŸ¥æœåŠ¡çŠ¶æ€
   â”œâ”€ å‰ç«¯æœåŠ¡ï¼ˆhttps://localhost:3000ï¼‰
   â””â”€ åç«¯æœåŠ¡ï¼ˆhttps://localhost:44320ï¼‰
   
2. è¿è¡Œ pytest
   â””â”€ pytest tests/test_<page_name>.py -v --alluredir=allure-results
   
3. æ”¶é›†æµ‹è¯•ç»“æœ
   
4. ç”Ÿæˆ Allure æŠ¥å‘Š
   
5. è‡ªåŠ¨æ‰“å¼€æŠ¥å‘Šï¼ˆå¿…é¡»ï¼‰
   â””â”€ allure serve allure-results
   â””â”€ åœ¨åå°å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨å¹¶è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨
   
6. åé¦ˆæµ‹è¯•ç»“æœæ‘˜è¦
```

## è‡ªåŠ¨åŒ–è§„åˆ™

**ä½•æ—¶è‡ªåŠ¨è¿è¡Œæµ‹è¯•**ï¼š
- âœ… ç”¨æˆ·è¯´"å¸®æˆ‘æµ‹è¯• xxx é¡µé¢"ï¼ˆç”Ÿæˆä»£ç åè‡ªåŠ¨è¿è¡Œï¼‰
- âœ… ç”¨æˆ·è¯´"æµ‹è¯• /admin/profile/change-password"ï¼ˆç”Ÿæˆä»£ç åè‡ªåŠ¨è¿è¡Œï¼‰
- âŒ ç”¨æˆ·è¯´"ç”Ÿæˆ xxx é¡µé¢çš„æµ‹è¯•ä»£ç "ï¼ˆåªç”Ÿæˆï¼Œä¸è¿è¡Œï¼‰
- âŒ ç”¨æˆ·è¯´"å¸®æˆ‘å†™æµ‹è¯•"ï¼ˆåªç”Ÿæˆï¼Œä¸è¿è¡Œï¼‰

**è§¦å‘è‡ªåŠ¨è¿è¡Œçš„å…³é”®è¯**ï¼š
- "æµ‹è¯• xxx é¡µé¢"
- "å¸®æˆ‘æµ‹è¯•"
- "è¿è¡Œæµ‹è¯•"
- "æ‰§è¡Œæµ‹è¯•"

## å®ç°ç»†èŠ‚

```python
# 0. æ¸…ç†æ—§çš„æµ‹è¯•æ•°æ®ï¼ˆå¿…é¡»ï¼‰â­
def clean_old_test_data():
    """æ¸…ç†æ—§çš„æµ‹è¯•æ•°æ®ï¼Œç¡®ä¿æ¯æ¬¡æµ‹è¯•éƒ½æ˜¯å¹²å‡€çš„å¼€å§‹"""
    import shutil
    import os
    
    # æ¸…ç† allure-results
    if os.path.exists("allure-results"):
        shutil.rmtree("allure-results")
        print("âœ… å·²æ¸…ç†æ—§çš„æµ‹è¯•ç»“æœ: allure-results/")
    
    # æ¸…ç† allure-report
    if os.path.exists("allure-report"):
        shutil.rmtree("allure-report")
        print("âœ… å·²æ¸…ç†æ—§çš„æµ‹è¯•æŠ¥å‘Š: allure-report/")
    
    # æ¸…ç† screenshots
    if os.path.exists("screenshots"):
        shutil.rmtree("screenshots")
        print("âœ… å·²æ¸…ç†æ—§çš„æµ‹è¯•æˆªå›¾: screenshots/")
    
    # é‡æ–°åˆ›å»ºå¿…è¦çš„ç›®å½•
    os.makedirs("allure-results", exist_ok=True)
    os.makedirs("screenshots", exist_ok=True)
    print("âœ… å·²åˆ›å»ºæ–°çš„æµ‹è¯•æ•°æ®ç›®å½•")

# 1. æ£€æŸ¥æœåŠ¡çŠ¶æ€
def check_services():
    """æ£€æŸ¥å‰ç«¯å’Œåç«¯æœåŠ¡æ˜¯å¦å¯åŠ¨"""
    frontend_url = "https://localhost:3000"
    backend_url = "https://localhost:44320"
    
    frontend_status = shell("curl -k {frontend_url} -I")
    backend_status = shell("curl -k {backend_url}/api/health -I")
    
    return frontend_status.success and backend_status.success

# 2. è¿è¡Œæµ‹è¯•
def run_tests(test_file: str):
    """è¿è¡Œç”Ÿæˆçš„æµ‹è¯•æ–‡ä»¶"""
    cmd = f"pytest {test_file} -v --alluredir=allure-results"
    result = shell(cmd, timeout=180000)  # 3åˆ†é’Ÿè¶…æ—¶
    return parse_pytest_output(result.output)

# 3. ç”Ÿæˆå¹¶è‡ªåŠ¨æ‰“å¼€ Allure æŠ¥å‘Š
def open_allure_report():
    """ç”Ÿæˆ Allure æŠ¥å‘Šå¹¶è‡ªåŠ¨åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€"""
    # allure serve ä¼šè‡ªåŠ¨:
    # 1. ç”ŸæˆæŠ¥å‘Š
    # 2. å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨
    # 3. è‡ªåŠ¨æ‰“å¼€é»˜è®¤æµè§ˆå™¨
    result = shell("allure serve allure-results", is_background=True)
    time.sleep(2)  # ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨
    return "http://localhost:éšæœºç«¯å£"
```

## æ¸…ç†æœºåˆ¶è¯´æ˜

### âš ï¸ ä¸ºä»€ä¹ˆè¦æ¸…ç†æ—§æ•°æ®ï¼Ÿ

1. **é¿å…æ•°æ®æ··æ·†**
   - æ—§çš„æµ‹è¯•ç»“æœã€æˆªå›¾ä¼šå’Œæ–°çš„æ··åœ¨ä¸€èµ·
   - Allure ä¼šæ˜¾ç¤ºæ‰€æœ‰å†å²æ•°æ®ï¼Œå¯¼è‡´æŠ¥å‘Šä¸å‡†ç¡®

2. **ç¡®ä¿ç»“æœå‡†ç¡®**
   - æ¯æ¬¡æµ‹è¯•éƒ½æ˜¯ç‹¬ç«‹çš„ã€å¹²å‡€çš„
   - æŠ¥å‘Šå’Œæˆªå›¾åªæ˜¾ç¤ºæœ¬æ¬¡æµ‹è¯•çš„ç»“æœ

3. **é¿å…ç£ç›˜ç©ºé—´æµªè´¹**
   - æµ‹è¯•æ•°æ®ä¼šä¸æ–­ç´¯ç§¯
   - å®šæœŸæ¸…ç†èŠ‚çœç©ºé—´

4. **ä¾¿äºé—®é¢˜å®šä½**
   - æˆªå›¾åªåŒ…å«æœ¬æ¬¡æµ‹è¯•
   - ä¸ä¼šè¢«å†å²æˆªå›¾å¹²æ‰°

### æ¸…ç†çš„å†…å®¹

| ç›®å½• | å†…å®¹ | æ¸…ç†æ–¹å¼ | åŸå›  |
|------|------|---------|------|
| `allure-results/` | æµ‹è¯•ç»“æœæ•°æ®ï¼ˆJSONï¼‰ | å®Œå…¨åˆ é™¤ + é‡å»º âœ… | æ¯æ¬¡é‡æ–°ç”Ÿæˆ |
| `allure-report/` | HTML æŠ¥å‘Š | å®Œå…¨åˆ é™¤ âœ… | æ¯æ¬¡é‡æ–°ç”Ÿæˆ |
| `screenshots/` | æµ‹è¯•æˆªå›¾ | å®Œå…¨åˆ é™¤ + é‡å»º âœ… | æ¯æ¬¡é‡æ–°ç”Ÿæˆ |

**æ‰€æœ‰æµ‹è¯•æ•°æ®éƒ½ä¼šè‡ªåŠ¨æ¸…ç†ï¼Œç¡®ä¿æ¯æ¬¡æµ‹è¯•éƒ½æ˜¯å…¨æ–°çš„å¼€å§‹ã€‚** âœ¨

### æ¸…ç†æ—¶æœº

```
ç”¨æˆ·è§¦å‘æµ‹è¯•
  â†“
Step 0: æ¸…ç†æ—§æ•°æ® â† â­ ç¬¬ä¸€æ­¥
  â”œâ”€ åˆ é™¤ allure-results/
  â”œâ”€ åˆ é™¤ allure-report/
  â”œâ”€ åˆ é™¤ screenshots/
  â”œâ”€ é‡å»º allure-results/
  â””â”€ é‡å»º screenshots/
  â†“
Step 1: æ£€æŸ¥æœåŠ¡
  â†“
Step 2: è¿è¡Œ pytest
  â†“
...
```

## ç»“æœåé¦ˆæ ¼å¼

**å…¨éƒ¨é€šè¿‡æ—¶**ï¼š
```
ğŸ§¹ æ¸…ç†æ—§æµ‹è¯•æ•°æ®...
âœ… å·²æ¸…ç†æ—§çš„æµ‹è¯•ç»“æœ: allure-results/
âœ… å·²æ¸…ç†æ—§çš„æµ‹è¯•æŠ¥å‘Š: allure-report/
âœ… å·²æ¸…ç†æ—§çš„æµ‹è¯•æˆªå›¾: screenshots/
âœ… å·²åˆ›å»ºæ–°çš„æµ‹è¯•æ•°æ®ç›®å½•

âœ… æµ‹è¯•å®Œæˆï¼æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼

ğŸ“Š æµ‹è¯•ç»“æœæ¦‚è§ˆ:
- æ€»æµ‹è¯•æ•°: 13
- âœ… é€šè¿‡: 13 (100%)

â±ï¸  æ‰§è¡Œæ—¶é—´: 45.3 ç§’

ğŸ“ Allure æŠ¥å‘Šå·²è‡ªåŠ¨æ‰“å¼€: http://localhost:xxxxx
   â†’ æµè§ˆå™¨ä¼šè‡ªåŠ¨å¼¹å‡ºæŠ¥å‘Šé¡µé¢
   â†’ å¯æŸ¥çœ‹è¯¦ç»†çš„æµ‹è¯•æ­¥éª¤ã€æˆªå›¾å’Œç»Ÿè®¡
```

**éƒ¨åˆ†å¤±è´¥æ—¶**ï¼š
```
ğŸ§¹ æ¸…ç†æ—§æµ‹è¯•æ•°æ®...
âœ… å·²æ¸…ç†æ—§çš„æµ‹è¯•ç»“æœ: allure-results/
âœ… å·²æ¸…ç†æ—§çš„æµ‹è¯•æŠ¥å‘Š: allure-report/
âœ… å·²æ¸…ç†æ—§çš„æµ‹è¯•æˆªå›¾: screenshots/
âœ… å·²åˆ›å»ºæ–°çš„æµ‹è¯•æ•°æ®ç›®å½•

âš ï¸ æµ‹è¯•å®Œæˆï¼éƒ¨åˆ†æµ‹è¯•å¤±è´¥

ğŸ“Š æµ‹è¯•ç»“æœæ¦‚è§ˆ:
- æ€»æµ‹è¯•æ•°: 13
- âœ… é€šè¿‡: 11 (85%)
- âŒ å¤±è´¥: 2 (15%)

âŒ å¤±è´¥çš„æµ‹è¯•è¯¦æƒ…:
1. test_p1_password_too_short
   â””â”€ åŸå› : åç«¯æœªå¯ç”¨ RequiredLength éªŒè¯è§„åˆ™
   â””â”€ å»ºè®®: æ£€æŸ¥åç«¯ ABP é…ç½®æˆ–è°ƒæ•´æµ‹è¯•æ–­è¨€

ğŸ“ Allure æŠ¥å‘Šå·²è‡ªåŠ¨æ‰“å¼€: http://localhost:xxxxx
   â†’ ç‚¹å‡»å¤±è´¥çš„æµ‹è¯•æŸ¥çœ‹å®Œæ•´æ—¥å¿—å’Œæˆªå›¾
```

## æ‰‹åŠ¨æ¸…ç†å‘½ä»¤ï¼ˆå¯é€‰ï¼‰

å¦‚æœéœ€è¦æ‰‹åŠ¨æ¸…ç†ï¼Œå¯ä»¥æ‰§è¡Œï¼š

```bash
# æ¸…ç†æ‰€æœ‰æµ‹è¯•ç›¸å…³æ•°æ®
rm -rf allure-results/ allure-report/ screenshots/

# æˆ–ä½¿ç”¨ Python è„šæœ¬
python -c "import shutil; shutil.rmtree('allure-results', ignore_errors=True); shutil.rmtree('allure-report', ignore_errors=True); shutil.rmtree('screenshots', ignore_errors=True); print('âœ… æ¸…ç†å®Œæˆ')"
```

---

**æ ¸å¿ƒåŸåˆ™ï¼šæ¯æ¬¡æµ‹è¯•éƒ½æ˜¯å¹²å‡€çš„å¼€å§‹ï¼Œæ‰€æœ‰æ•°æ®åªåæ˜ æœ¬æ¬¡æµ‹è¯•ç»“æœã€‚** âœ¨
