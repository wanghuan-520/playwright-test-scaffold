# ═══════════════════════════════════════════════════════════════
# Playwright Test Scaffold - Project Configuration (Aevatar)
# ═══════════════════════════════════════════════════════════════
#
# 说明：
# - 本文件是运行测试的“单一真相源”，用于：
#   - 服务地址（frontend/backend）
#   - 账号池路径
#   - 可选的服务自启动命令
#

project:
  name: "Aevatar Agent Station"
  description: "AI Agent 管理平台 - 自动化测试"
  version: "1.0.0"

repositories:
  frontend:
    local_path: ""
    url: "https://github.com/aevatarAI/aevatar-agent-station-frontend"
    branch: "main"
    description: "Aevatar Agent Station 前端 - Next.js 15 + React 19 + TypeScript"
    tech_stack:
      framework: "Next.js"
      version: "15.1.6"
      language: "TypeScript"
      ui_library: "React 19"
  backend:
    local_path: ""
    url: "https://github.com/louis4li/aevatar-agent-framework"
    branch: "feature/auth-server-admin-ui"
    description: "Aevatar Agent Framework 后端 - ABP Framework + .NET Aspire"
    tech_stack:
      framework: "ABP Framework"
      version: "8.3"
      language: ".NET"
      runtime: ".NET Aspire"

environments:
  default: "dev"
  dev:
    frontend:
      url: "https://localhost:3000"
      health_check: "/"
    backend:
      url: "https://localhost:44320"
      health_check: "/api/health"

test_data:
  accounts:
    path: "test-data/test_account_pool.json"
    description: "测试账号池"

service_startup:
  enabled: true
  auto_start: true
  frontend:
    type: "npm"
    command: "npm run dev:local"
    cwd: "/Users/wanghuan/aelf/Aevatar/aevatar-agent-station-frontend"
    env: {}
    timeout: 60
  backend:
    type: "dotnet"
    command: "dotnet run --project src/Aevatar.BusinessServer/src/Aevatar.BusinessServer.AppHost/Aevatar.BusinessServer.AppHost.csproj"
    cwd: "/Users/wanghuan/aelf/Aevatar/aevatar-agent-framework"
    env: {}
    timeout: 120

health_check:
  enabled: true
  timeout: 10
  retry_count: 3
  retry_interval: 2

browser:
  headless: true
  slow_mo: 0
  timeout: 30000
  viewport:
    width: 1920
    height: 1080
  type: "chromium"
  args:
    - "--disable-web-security"
    - "--ignore-certificate-errors"
    - "--allow-insecure-localhost"
    - "--disable-gpu"
    - "--no-sandbox"

test:
  retry_count: 2
  implicit_wait: 10
  screenshot_on_failure: true
  video_recording: false
  parallel_workers: "auto"

reports:
  allure:
    enabled: true
    results_dir: "allure-results"
    report_dir: "allure-report"

# ═══════════════════════════════════════════════════════════════
# Playwright Test Scaffold - Project Configuration
# ═══════════════════════════════════════════════════════════════
# AI 驱动的自动化测试脚手架 - 项目配置中心

# ─────────────────────────────────────────────────────────────────
# 项目基本信息
# ─────────────────────────────────────────────────────────────────
project:
  name: "Aevatar Agent Station"
  description: "AI Agent 管理平台 - 自动化测试"
  version: "1.0.0"

# ─────────────────────────────────────────────────────────────────
# 代码仓库配置（本地路径或 GitHub URL）
# ─────────────────────────────────────────────────────────────────
repositories:
  frontend:
    # 本地路径（用于代码分析）
    local_path: ""
    url: "https://github.com/aevatarAI/aevatar-agent-station-frontend"
    branch: "main"
    description: "Aevatar Agent Station 前端 - Next.js 15 + React 19 + TypeScript"
    tech_stack:
      framework: "Next.js"
      version: "15.1.6"
      language: "TypeScript"
      ui_library: "React 19"
  
  backend:
    # 本地路径（用于代码分析）
    local_path: ""
    url: "https://github.com/louis4li/aevatar-agent-framework"
    branch: "feature/auth-server-admin-ui"
    description: "Aevatar Agent Framework 后端 - ABP Framework + .NET Aspire"
    tech_stack:
      framework: "ABP Framework"
      version: "8.3"
      language: ".NET"
      runtime: ".NET Aspire"

# ─────────────────────────────────────────────────────────────────
# 多环境服务地址配置
# ─────────────────────────────────────────────────────────────────
environments:
  default: "dev"
  
  dev:
    frontend:
      url: "https://localhost:3000"
      health_check: "/"                  # 健康检查路径
    backend:
      url: "https://localhost:44320"
      health_check: "/api/health"
  
  staging:
    frontend:
      url: "https://staging.example.com"
      health_check: "/"
    backend:
      url: "https://staging-api.example.com"
      health_check: "/api/health"
  
  production:
    frontend:
      url: "https://www.example.com"
      health_check: "/"
    backend:
      url: "https://api.example.com"
      health_check: "/api/health"

# ─────────────────────────────────────────────────────────────────
# 测试数据配置（支持多种类型）
# ─────────────────────────────────────────────────────────────────
test_data:
  # 测试账号池
  accounts:
    path: "test-data/test_account_pool.json"
    description: "测试账号池"
  
  # 可扩展：添加其他测试数据类型
  # orders:
  #   path: "test-data/orders.json"
  #   description: "订单测试数据"
  #
  # products:
  #   path: "test-data/products.json"
  #   description: "商品测试数据"

# ─────────────────────────────────────────────────────────────────
# 服务启动配置（可选）
# ─────────────────────────────────────────────────────────────────
service_startup:
  enabled: true                          # 是否启用自动启动
  auto_start: true                       # 检测到服务未启动时自动启动
  
  frontend:
    # 启动方式: npm, yarn, dotnet, python, custom
    type: "npm"
    # 启动命令（使用 local 环境启动）
    command: "npm run dev:local"
    # 工作目录（前端项目路径）
    cwd: "/Users/wanghuan/aelf/Aevatar/aevatar-agent-station-frontend"
    # 环境变量
    env: {}
    # 启动超时时间（秒）
    timeout: 60
  
  backend:
    type: "dotnet"
    # Aspire 启动命令（使用 AppHost 项目）
    command: "dotnet run --project src/Aevatar.BusinessServer/src/Aevatar.BusinessServer.AppHost/Aevatar.BusinessServer.AppHost.csproj"
    # 工作目录（后端项目路径）
    cwd: "/Users/wanghuan/aelf/Aevatar/aevatar-agent-framework"
    # 环境变量
    env: {}
    # 启动超时时间（秒）- Aspire 启动较慢，设置为 120 秒
    timeout: 120

# ─────────────────────────────────────────────────────────────────
# 服务健康检查配置
# ─────────────────────────────────────────────────────────────────
health_check:
  enabled: true                          # 是否启用服务检查
  timeout: 10                            # 超时时间（秒）
  retry_count: 3                         # 重试次数
  retry_interval: 2                      # 重试间隔（秒）

# ─────────────────────────────────────────────────────────────────
# 浏览器配置
# ─────────────────────────────────────────────────────────────────
browser:
  headless: true                         # 无头模式
  slow_mo: 0                             # 操作延迟（毫秒）
  timeout: 30000                         # 默认超时（毫秒）
  viewport:
    width: 1920
    height: 1080
  type: "chromium"                       # chromium, firefox, webkit
  args:
    - "--disable-web-security"
    - "--ignore-certificate-errors"
    - "--allow-insecure-localhost"
    - "--disable-gpu"
    - "--no-sandbox"

# ─────────────────────────────────────────────────────────────────
# 测试执行配置
# ─────────────────────────────────────────────────────────────────
test:
  retry_count: 2                         # 失败重试次数
  implicit_wait: 10                      # 隐式等待时间（秒）
  screenshot_on_failure: true            # 失败时截图
  video_recording: false                 # 视频录制
  parallel_workers: "auto"               # 并行 worker 数量

# ─────────────────────────────────────────────────────────────────
# 报告配置
# ─────────────────────────────────────────────────────────────────
reports:
  allure:
    enabled: true
    results_dir: "allure-results"
    report_dir: "allure-report"
