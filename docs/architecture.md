# Playwright Test Scaffold - Architecture

> AI é©±åŠ¨çš„è‡ªåŠ¨åŒ–æµ‹è¯•è„šæ‰‹æ¶ - æ¶æ„æ–‡æ¡£

## ä½¿ç”¨æ–¹å¼

**æœ¬é¡¹ç›®åªé€šè¿‡ AI å¯¹è¯äº¤äº’**ï¼Œç”¨è‡ªç„¶è¯­è¨€æè¿°éœ€æ±‚ï¼ŒAI è‡ªåŠ¨å®Œæˆï¼š
- æ£€æŸ¥æœåŠ¡çŠ¶æ€
- **åˆ†æ GitHub ä»£ç ** - æ ¹æ®é¡µé¢ URL æŸ¥æ‰¾å¯¹åº”ä»£ç ï¼Œæå–åŠŸèƒ½ç‚¹
- ç”Ÿæˆ Page Object
- ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹ï¼ˆè¦†ç›–æ‰€æœ‰åˆ†æå‡ºçš„åŠŸèƒ½ç‚¹ï¼‰
- æ‰§è¡Œæµ‹è¯•
- æŸ¥çœ‹æŠ¥å‘Š

## é¡µé¢åŠŸèƒ½åˆ†ææµç¨‹

```
é¡µé¢ URL â†’ æ¨æ–­ä»£ç ä½ç½® â†’ DeepWiki æŸ¥è¯¢ä»£ç  â†’ æå–åŠŸèƒ½ç‚¹ â†’ ç”Ÿæˆæµ‹è¯•
```

| åˆ†æç»´åº¦ | å…³æ³¨ç‚¹ |
|----------|--------|
| è¡¨å•å­—æ®µ | è¾“å…¥æ¡†ã€ä¸‹æ‹‰æ¡†ã€å¿…å¡«/å¯é€‰ |
| éªŒè¯è§„åˆ™ | æ­£åˆ™ã€é•¿åº¦é™åˆ¶ã€æ ¼å¼è¦æ±‚ |
| API æ¥å£ | è¯·æ±‚æ–¹æ³•ã€å‚æ•°ã€å“åº” |
| ä¸šåŠ¡é€»è¾‘ | æ¡ä»¶åˆ¤æ–­ã€æµç¨‹åˆ†æ”¯ |

## ç›®å½•ç»“æ„

```
playwright-test-scaffold/
â”œâ”€â”€ conftest.py                   # pytest æ ¹é…ç½®
â”œâ”€â”€ pytest.ini                    # pytest é…ç½®
â”œâ”€â”€ requirements.txt              # ä¾èµ–æ¸…å•
â”‚
â”œâ”€â”€ config/
â”‚   â””â”€â”€ project.yaml              # é¡¹ç›®é…ç½®ä¸­å¿ƒï¼ˆä»“åº“/æœåŠ¡/æ•°æ®ï¼‰
â”‚
â”œâ”€â”€ core/                         # æ ¸å¿ƒæ¡†æ¶å±‚
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ base_page.py              # Page Object åŸºç±»
â”‚   â”œâ”€â”€ fixtures.py               # pytest fixtures
â”‚   â””â”€â”€ page_utils.py             # é¡µé¢å·¥å…·å‡½æ•°
â”‚
â”œâ”€â”€ generators/                   # ä»£ç ç”Ÿæˆå¼•æ“
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ utils.py                  # å…¬å…±å·¥å…·
â”‚   â”œâ”€â”€ page_analyzer.py          # é¡µé¢åˆ†æå™¨
â”‚   â”œâ”€â”€ test_plan_generator.py    # æµ‹è¯•è®¡åˆ’ç”Ÿæˆ
â”‚   â””â”€â”€ test_code_generator.py    # ä»£ç ç”Ÿæˆ
â”‚
â”œâ”€â”€ utils/                        # å·¥å…·æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ config.py                 # é…ç½®ç®¡ç†å™¨
â”‚   â”œâ”€â”€ logger.py                 # æ—¥å¿—ç³»ç»Ÿ
â”‚   â””â”€â”€ service_checker.py        # ğŸ†• æœåŠ¡å¥åº·æ£€æŸ¥
â”‚
â”œâ”€â”€ pages/                        # Page Object å®ç°å±‚
â”‚   â””â”€â”€ *.py
â”‚
â”œâ”€â”€ tests/                        # æµ‹è¯•ç”¨ä¾‹å±‚
â”‚   â””â”€â”€ test_*.py
â”‚
â”œâ”€â”€ test-data/                    # æµ‹è¯•æ•°æ®
â”‚   â””â”€â”€ test_account_pool.json    # æµ‹è¯•è´¦å·æ± 
â”‚
â”œâ”€â”€ docs/                         # æ–‡æ¡£
â”‚   â”œâ”€â”€ architecture.md           # æœ¬æ–‡æ¡£
â”‚   â””â”€â”€ test-plans/               # ç”Ÿæˆçš„æµ‹è¯•è®¡åˆ’
â”‚
â”œâ”€â”€ reports/                      # æµ‹è¯•æŠ¥å‘Š
â”œâ”€â”€ screenshots/                  # æˆªå›¾
â””â”€â”€ allure-results/               # Allure æ•°æ®
```

## æ¨¡å—èŒè´£

### `config/project.yaml` (é¡¹ç›®é…ç½®ä¸­å¿ƒ)

ç»Ÿä¸€ç®¡ç†æ‰€æœ‰é¡¹ç›®é…ç½®ï¼š

| é…ç½®é¡¹ | ç”¨é€” |
|--------|------|
| `repositories` | GitHub ä»“åº“åœ°å€ï¼ˆå‰ç«¯/åç«¯ï¼‰ |
| `environments` | å¤šç¯å¢ƒæœåŠ¡åœ°å€é…ç½® |
| `test_data` | æµ‹è¯•æ•°æ®æ–‡ä»¶è·¯å¾„ |
| `health_check` | æœåŠ¡å¥åº·æ£€æŸ¥é…ç½® |
| `browser` | æµè§ˆå™¨é…ç½® |

### `utils/config.py` (é…ç½®ç®¡ç†å™¨)

| æ–¹æ³• | åŠŸèƒ½ |
|------|------|
| `get_repository(name)` | è·å–ä»“åº“é…ç½® |
| `get_service_url(name)` | è·å–å½“å‰ç¯å¢ƒçš„æœåŠ¡ URL |
| `get_health_check_url(name)` | è·å–å¥åº·æ£€æŸ¥ URL |
| `get_test_data_path(name)` | è·å–æµ‹è¯•æ•°æ®è·¯å¾„ |
| `load_test_data(name)` | åŠ è½½æµ‹è¯•æ•°æ® |
| `get_all_services()` | è·å–æ‰€æœ‰æœåŠ¡é…ç½® |

### `utils/service_checker.py` (æœåŠ¡å¥åº·æ£€æŸ¥)

| æ–¹æ³• | åŠŸèƒ½ |
|------|------|
| `check_service(name)` | æ£€æŸ¥å•ä¸ªæœåŠ¡ |
| `check_all_services()` | æ£€æŸ¥æ‰€æœ‰æœåŠ¡ |
| `wait_for_service(name)` | ç­‰å¾…æœåŠ¡å¯åŠ¨ |
| `get_status_report()` | è·å–æ ¼å¼åŒ–çŠ¶æ€æŠ¥å‘Š |

### `core/fixtures.py` (Pytest Fixtures)

| Fixture | åŠŸèƒ½ |
|---------|------|
| `frontend_url` | å‰ç«¯æœåŠ¡ URL |
| `backend_url` | åç«¯æœåŠ¡ URL |
| `test_account` | æµ‹è¯•è´¦å· |
| `test_data` | é€šç”¨æµ‹è¯•æ•°æ®åŠ è½½å™¨ |
| `service_checker` | æœåŠ¡æ£€æŸ¥å™¨ |
| `ensure_services_running` | ç¡®ä¿æœåŠ¡è¿è¡Œ |

### `generators/page_analyzer.py` (é¡µé¢åˆ†æå™¨)

- ä½¿ç”¨ Playwright è·å–é¡µé¢å¿«ç…§
- è‡ªåŠ¨è¯†åˆ«é¡µé¢ç±»å‹ (LOGIN, FORM, LIST...)
- æå–å¯äº¤äº’å…ƒç´ 

### `generators/test_code_generator.py` (ä»£ç ç”Ÿæˆ)

- è¾“å…¥: `PageInfo`
- è¾“å‡º: Page Object + æµ‹è¯•ç”¨ä¾‹ + æµ‹è¯•æ•°æ®

### `core/base_page.py` (Page Object åŸºç±»)

- æ¨¡æ¿æ–¹æ³•æ¨¡å¼
- å¼ºåˆ¶å­ç±»å®ç° `navigate()` å’Œ `is_loaded()`

## è®¾è®¡åŸåˆ™

1. **AI ä¼˜å…ˆ** - æ‰€æœ‰æ“ä½œé€šè¿‡è‡ªç„¶è¯­è¨€å¯¹è¯å®Œæˆ
2. **é…ç½®é›†ä¸­** - æ‰€æœ‰é…ç½®ç»Ÿä¸€åœ¨ `project.yaml`
3. **æœåŠ¡æ„ŸçŸ¥** - æµ‹è¯•å‰è‡ªåŠ¨æ£€æŸ¥æœåŠ¡çŠ¶æ€
4. **å¤šç¯å¢ƒæ”¯æŒ** - æ”¯æŒ dev/staging/production å¤šå¥—é…ç½®
5. **DRY** - å…¬å…±é€»è¾‘æå–å¤ç”¨

## å˜æ›´æ—¥å¿—

| æ—¥æœŸ | å˜æ›´ |
|------|------|
| 2025-12-15 | æ–°å¢æœåŠ¡å¥åº·æ£€æŸ¥æ¨¡å— |
| 2025-12-15 | æ‰©å±•é…ç½®ç»“æ„ï¼ˆä»“åº“/å¤šç¯å¢ƒ/æµ‹è¯•æ•°æ®ï¼‰ |
| 2025-12-15 | ç§»é™¤ CLIï¼Œæ”¹ä¸ºçº¯ AI å¯¹è¯é©±åŠ¨ |
| 2025-12-09 | åˆ›å»º `generators/utils.py`ï¼Œé‡æ„ç”Ÿæˆå™¨ |
