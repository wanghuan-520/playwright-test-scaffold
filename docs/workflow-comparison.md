# 测试工作流对比：已知页面 vs 未知页面

**I'm HyperEcho, 在共振着工作流对比的频率** 🌌

---

## 🎯 两种场景

### 场景 A：已知页面（有现成测试）✅
**特征**：
- ✅ 规约文档已存在（`specs/###-slug/spec.md`）
- ✅ 页面对象已实现（`pages/xxx_page.py`）
- ✅ 测试代码已编写（`tests/xxx/test_*.py`）

**目标**：快速运行测试，验证功能

### 场景 B：未知页面（完全从零开始）🚀
**特征**：
- ❌ 只有 URL + 账号 + 密码
- ❌ 不了解页面功能
- ❌ 没有任何文档或代码

**目标**：从零到完整测试套件

---

## 📊 工作流对比

### 场景 A：已知页面（3 步，5 分钟）

```
┌─────────────────────────────────────────┐
│   场景 A：已知页面快速测试流程           │
└─────────────────────────────────────────┘

步骤 1：运行测试
─────────────────────────────────────────
命令：make test TEST_TARGET=tests/admin/users
时间：2 分钟
输出：测试结果

           ↓

步骤 2：生成报告
─────────────────────────────────────────
命令：make report
时间：1 分钟
输出：Allure 报告

           ↓

步骤 3：查看报告
─────────────────────────────────────────
命令：make serve
时间：1 分钟
输出：浏览器报告（http://127.0.0.1:59717）

✅ 总时间：5 分钟
✅ 复杂度：低
✅ 适合场景：日常回归测试、验证修复
```

### 场景 B：未知页面（6 阶段，30 分钟）

```
┌─────────────────────────────────────────┐
│   场景 B：未知页面完整测试流程           │
└─────────────────────────────────────────┘

阶段 0：页面探索（5 分钟）
─────────────────────────────────────────
工具：@ui-test-plan-generator.mdc + Playwright MCP
操作：AI 自动打开浏览器、登录、分析页面
输出：
  ✓ 页面截图
  ✓ HTML 结构
  ✓ 元素映射
  ✓ 测试计划（docs/test-plans/<slug>.md）

           ↓

阶段 1：功能规约（5 分钟）
─────────────────────────────────────────
工具：/speckit.specify
操作：基于页面探索结果，生成功能规约
输出：specs/###-slug/spec.md
  ✓ 用户故事
  ✓ 验收标准
  ✓ 风险评估

           ↓

阶段 2：测试计划（5 分钟）
─────────────────────────────────────────
工具：/speckit.plan
操作：生成技术实现计划
输出：specs/###-slug/plan.md
  ✓ 技术栈
  ✓ 项目结构
  ✓ 测试策略

           ↓

阶段 3：任务分解（3 分钟）
─────────────────────────────────────────
工具：/speckit.tasks
操作：生成可追踪的任务清单
输出：specs/###-slug/tasks.md
  ✓ 分阶段任务
  ✓ 验收条件

           ↓

阶段 4：代码生成（7 分钟）
─────────────────────────────────────────
工具：@ui-automation-code-generator.mdc
操作：AI 自动生成完整的测试代码
输出：
  ✓ pages/<slug>_page.py
  ✓ tests/<module>/<page>/test_*.py
  ✓ test-data/<slug>_data.json

           ↓

阶段 5：执行验证（5 分钟）
─────────────────────────────────────────
工具：make test + Allure
操作：运行测试，生成报告
输出：
  ✓ 测试结果
  ✓ Allure 报告
  ✓ 截图证据

✅ 总时间：30 分钟
✅ 复杂度：中
✅ 适合场景：新功能测试、探索式测试
```

---

## 🔄 两种流程的关系

```
未知页面流程（场景 B）
    ↓ (执行一次，生成所有资源)
已知页面流程（场景 A）
    ↓ (持续使用，日常测试)
```

**关键点**：
- **场景 B 是场景 A 的前置步骤**
- **场景 B 只需执行一次**（初次探索页面时）
- **场景 A 可以无限重复**（每次测试时）

---

## 📋 快速决策指南

### 何时使用场景 A（已知页面）？

✅ **使用场景 A，如果**：
- 页面已有测试代码（`tests/xxx/` 存在）
- 只是想验证功能是否正常
- 进行回归测试
- 验证 Bug 修复

**命令**：
```bash
make test TEST_TARGET=tests/admin/users
make report && make serve
```

---

### 何时使用场景 B（未知页面）？

✅ **使用场景 B，如果**：
- 页面完全没有测试代码
- 只知道 URL，不了解功能
- 需要从零创建测试套件
- 探索新功能

**命令**：
```
# 在 Cursor 中依次执行
1. @ui-test-plan-generator.mdc
2. /speckit.specify
3. /speckit.plan
4. /speckit.tasks
5. @ui-automation-code-generator.mdc
6. make test TEST_TARGET=tests/xxx
```

---

## 🎓 学习路径建议

### 第 1 天：熟悉场景 A（已知页面）

**目标**：了解测试执行流程

```bash
# 1. 运行现有测试
make test TEST_TARGET=tests/admin/users

# 2. 查看报告
make report && make serve

# 3. 理解测试结果
```

**学习重点**：
- 如何读取测试结果
- 如何查看 Allure 报告
- 如何理解测试覆盖率

---

### 第 2 天：体验场景 B（未知页面）

**目标**：创建一个简单的测试

```
# 在 Cursor 中
1. @ui-test-plan-generator.mdc 探索页面
2. /speckit.specify 生成规约
3. /speckit.plan 生成计划
4. /speckit.tasks 生成任务
5. @ui-automation-code-generator.mdc 生成代码

# 在终端
6. make test TEST_TARGET=tests/xxx
```

**学习重点**：
- 如何让 AI 探索页面
- 如何生成功能规约
- 如何生成测试代码

---

### 第 3 天：深度实践

**目标**：优化和扩展测试

- 阅读生成的代码，理解结构
- 手动调整测试用例
- 添加更多断言
- 优化定位器

---

## 💡 实战技巧

### 技巧 1：先用场景 A 验证环境

```bash
# 在尝试场景 B 之前，先确认环境正常
make test TEST_TARGET=tests/admin/users
```

**为什么？**
- 如果现有测试都失败，说明环境有问题
- 先修复环境问题，再探索新页面

---

### 技巧 2：场景 B 后保存所有文档

**完成场景 B 后，确认以下文件都已生成**：

```
✅ specs/###-slug/spec.md       ← 功能规约
✅ specs/###-slug/plan.md       ← 技术计划
✅ specs/###-slug/tasks.md      ← 任务清单
✅ pages/xxx_page.py            ← 页面对象
✅ tests/xxx/test_*.py          ← 测试代码
✅ test-data/xxx_data.json      ← 测试数据
```

**为什么？**
- 这些文档是证据链，必须保存
- 未来维护时需要参考

---

### 技巧 3：定期回到场景 A

**不要每次都走场景 B！**

- 场景 B：初次探索页面时使用
- 场景 A：日常测试时使用

**原因**：
- 场景 B 耗时 30 分钟，场景 A 只需 5 分钟
- 场景 B 适合探索，场景 A 适合验证

---

## 📊 完整对比表

| 维度 | 场景 A（已知页面） | 场景 B（未知页面） |
|------|-------------------|-------------------|
| **输入** | 已有测试代码 | URL + 账号 + 密码 |
| **工具** | make test | MCP + Spec-Kit + 代码生成 |
| **步骤** | 3 步 | 6 阶段 |
| **时间** | 5 分钟 | 30 分钟 |
| **复杂度** | 低 | 中 |
| **适合场景** | 回归测试、验证修复 | 新功能、探索测试 |
| **输出** | 测试报告 | 完整测试套件 + 报告 |
| **频率** | 高（每天多次） | 低（每个页面一次） |
| **学习曲线** | 平缓 | 适中 |

---

## 🚀 立即开始

### 如果你有已知页面要测试：

```bash
# 查看已有测试
ls -la tests/admin/users/

# 运行测试
make test TEST_TARGET=tests/admin/users

# 查看报告
make report && make serve
```

**参考文档**：`docs/spec-kit-hands-on-guide.md`

---

### 如果你有未知页面要测试：

```
# 在 Cursor 中
1. @ui-test-plan-generator.mdc
   输入：URL + 账号 + 密码
   
2. /speckit.specify
   输入：描述页面功能
   
3. /speckit.plan
   自动生成计划
   
4. /speckit.tasks
   自动生成任务
   
5. @ui-automation-code-generator.mdc
   自动生成代码
   
6. 在终端运行测试
```

**参考文档**：`docs/unknown-page-complete-workflow.md` ⭐

---

## 📚 相关文档

### 快速参考
- **[未知页面完整流程](./unknown-page-complete-workflow.md)** ⭐ - 场景 B 详细指南
- **[已知页面实战手册](./spec-kit-hands-on-guide.md)** - 场景 A 详细指南
- **[快速入门](./spec-kit-quickstart.md)** - 5 分钟上手

### 深度学习
- **[Spec-Kit 框架详解](./spec-kit-guide.md)** - 理论和架构
- **[宪法深度解读](./constitution-deep-dive.md)** - 设计哲学
- **[测试报告管理](./test-reports-management.md)** - 报告组织规范

---

**I'm HyperEcho, 在工作流对比的共振中完成** 🌌

哥，现在你应该清楚了：

1. **已知页面（场景 A）**：3 步，5 分钟，运行测试
2. **未知页面（场景 B）**：6 阶段，30 分钟，创建测试

**关键是选对场景！**

- 有测试代码 → 场景 A
- 没有测试代码 → 场景 B

现在，告诉我：你想测试的是已知页面还是未知页面？🚀

